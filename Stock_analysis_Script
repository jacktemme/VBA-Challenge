Sub module2()For Each ws In Worksheetsws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 10).Value = "Yearly Change"ws.Cells(1, 11).Value = "Percent Change"ws.Cells(1, 12).Value = "Total Stock Volume"lastrow = ws.Cells(Rows.Count, 1).End(xlUp).RowDim ticker As StringDim volume_total As DoubleDim table_row As IntegerDim stock_open As DoubleDim stock_close As DoubleDim yearly_change As DoubleDim percent_change As DoubleDim year_start As Longyear_start = ws.Cells(2, 2).Valuetable_row = 2volume_total = 0For i = 2 To lastrow              If ws.Cells(i, 2).Value = year_start Then       stock_open = ws.Cells(i, 3).Value              volume_total = volume_total + ws.Cells(i, 7).Value               ElseIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            ticker = ws.Cells(i, 1).Value        stock_close = ws.Cells(i, 6).Value        yearly_change = stock_close - stock_open        percent_change = (stock_close - stock_open) / stock_open        volume_total = volume_total + ws.Cells(i, 7).Value        ws.Cells(table_row, 9).Value = ticker        ws.Cells(table_row, 10).Value = Round(yearly_change, 2)        ws.Cells(table_row, 11).Value = FormatPercent(percent_change, 2)        ws.Cells(table_row, 12).Value = volume_total                        volume_total = 0        table_row = table_row + 1                Else            volume_total = volume_total + ws.Cells(i, 7).Value                                      End If    Next i    lastrow2 = ws.Cells(Rows.Count, 9).End(xlUp).RowFor i = 2 To lastrow2    If ws.Cells(i, 10) > 0 Then        ws.Cells(i, 10).Interior.ColorIndex = 4        ws.Cells(i, 11).Interior.ColorIndex = 4            ElseIf ws.Cells(i, 10) < 0 Then        ws.Cells(i, 10).Interior.ColorIndex = 3        ws.Cells(i, 11).Interior.ColorIndex = 3            End If    Next iws.Range("P1").Value = "Ticker"ws.Range("Q1").Value = "Value"ws.Range("O2").Value = "Greatest % Increase"ws.Range("O3").Value = "Greatest % Decrease"ws.Range("O4").Value = "Greatest Total Volume"Dim greatest_increase As DoubleDim greatest_decrease As DoubleDim greatest_volume As DoubleDim rng_percent As RangeDim rng_volume As RangeSet rng_percent = ws.Range("k2:k" & lastrow2)Set rng_volume = ws.Range("l2:l" & lastrow2)greatest_increase = Application.WorksheetFunction.Max(rng_percent)greatest_decrease = Application.WorksheetFunction.Min(rng_percent)greatest_volume = Application.WorksheetFunction.Max(rng_volume)For i = 2 To lastrow2    If ws.Cells(i, 11).Value = greatest_increase Then                ws.Range("P2").Value = ws.Cells(i, 9).Value        ws.Range("Q2").Value = FormatPercent(ws.Cells(i, 11).Value, 2)            End If         If ws.Cells(i, 11).Value = greatest_decrease Then                ws.Range("P3").Value = ws.Cells(i, 9).Value        ws.Range("Q3").Value = FormatPercent(ws.Cells(i, 11).Value, 2)                    End If             If ws.Cells(i, 12).Value = greatest_volume Then                ws.Range("P4").Value = ws.Cells(i, 9).Value        ws.Range("Q4").Value = ws.Cells(i, 12).Value            End If          Next i            Next wsEnd Sub