Sub module2()

For Each ws In Worksheets

ws.Cells(1, 9).Value = "Ticker"
ws.Cells(1, 10).Value = "Yearly Change"
ws.Cells(1, 11).Value = "Percent Change"
ws.Cells(1, 12).Value = "Total Stock Volume"

lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row


Dim ticker As String
Dim volume_total As Double
Dim table_row As Integer
Dim stock_open As Double
Dim stock_close As Double
Dim yearly_change As Double
Dim percent_change As Double


table_row = 2
volume_total = 0

For i = 2 To lastrow

    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
    
        ticker = ws.Cells(i, 1).Value
        
        stock_close = ws.Cells(i, 6).Value
        yearly_change = stock_open - stock_close
        percent_change = ((stock_close / stock_open) / stock_open)
       
        
        volume_total = volume_total + ws.Cells(i, 7).Value

        ws.Cells(table_row, 9).Value = ticker
        ws.Cells(table_row, 10).Value = Round(yearly_change, 2)
        ws.Cells(table_row, 11).Value = FormatPercent(percent_change, 2)
        ws.Cells(table_row, 12).Value = volume_total
        
        
        volume_total = 0
        table_row = table_row + 1
        
        Else
            volume_total = volume_total + ws.Cells(i, 7).Value
            
                    If i = 2 Then
                        stock_open = ws.Cells(i, 3).Value
                    End If
                    
            
        End If
        
    Next i
    


For i = 2 To lastrow

    If ws.Cells(i, 10) > 0 Then
        ws.Cells(i, 10).Interior.ColorIndex = 4
        
    ElseIf ws.Cells(i, 10) < 0 Then
        ws.Cells(i, 10).Interior.ColorIndex = 3
        
    End If
    
Next i



Next ws


End Sub
